# Hybits CRM - Complete Software Flow Documentation
## End-to-End System Flow for Testing Planning

---

## ğŸ“‹ TABLE OF CONTENTS
1. [Authentication & Authorization Flow](#1-authentication--authorization-flow)
2. [User Roles & Permissions](#2-user-roles--permissions)
3. [Main Application Modules](#3-main-application-modules)
4. [Core Business Workflows](#4-core-business-workflows)
5. [Data Flow & Integration](#5-data-flow--integration)
6. [Delete Functionality](#6-delete-functionality)
7. [Image Handling Flow](#7-image-handling-flow)
8. [Testing Checklist](#8-testing-checklist)

---

## 1. AUTHENTICATION & AUTHORIZATION FLOW

### 1.1 Login Flow
```
User Access â†’ Login Page (/login)
    â†“
Enter Email & Password
    â†“
AuthService.login() â†’ Supabase Auth
    â†“
Session Created â†’ User Profile Loaded
    â†“
Outlet Assignment (Based on Role)
    â†“
Redirect to Dashboard (/dashboard)
```

### 1.2 Session Management
- **Session Check**: On app load, checks existing Supabase session
- **Auto-logout**: Session expires â†’ Redirect to login
- **Outlet Context**: User's assigned outlet loaded automatically
- **Role-based Redirect**: 
  - Admin/Manager â†’ Dashboard
  - Accountant â†’ Accounting Page

### 1.3 Logout Flow
```
User Clicks Logout â†’ AuthService.logout()
    â†“
Supabase Session Cleared
    â†“
User State Cleared â†’ Outlet Context Cleared
    â†“
Redirect to Login Page
```

---

## 2. USER ROLES & PERMISSIONS

### 2.1 Role Types
| Role | Access Level | Outlet Access |
|------|-------------|---------------|
| **Admin** | Full system access | All outlets |
| **Manager** | Operational access | Assigned outlet only |
| **Accountant** | Financial access | All outlets |

### 2.2 Permission Matrix

#### **CORE**
- **Dashboard**: Admin, Manager âœ…

#### **OPERATIONS**
- **Inventory**: Admin, Manager âœ…
- **Customers**: Admin, Manager âœ…
- **Orders**: Admin, Manager âœ…

#### **BILLING**
- **Invoices**: Admin, Manager, Accountant âœ…
- **Payments**: Admin, Manager, Accountant âœ…

#### **SUBSCRIPTIONS**
- **Customer Subscriptions**: Admin, Manager, Accountant âœ…
- **Vendor Subscriptions**: Admin, Manager âœ…

#### **BUSINESS**
- **Vendors**: Admin, Manager âœ…
- **Accounting**: Admin, Manager, Accountant âœ…

#### **ADMINISTRATION**
- **Outlets**: Admin only âœ…
- **Users**: Admin only âœ…
- **Settings**: Admin only âœ…
- **Overdue Runner**: Admin, Manager âœ…

---

## 3. MAIN APPLICATION MODULES

### 3.1 Dashboard Module (`/dashboard`)
**Flow:**
```
Load Dashboard â†’ Check User Permissions
    â†“
Fetch Statistics (Based on Role):
    - Admin: Aggregated + Outlet-specific stats
    - Manager: Outlet-specific stats only
    â†“
Display:
    - Total Customers
    - Total Orders
    - Total Revenue
    - Active Orders
    - Recent Orders List
    - Quick Actions
```

**Data Sources:**
- `dashboardService.getAggregatedStats()` - For admin
- `dashboardService.getOutletStats(outletId)` - For manager/admin
- `dashboardService.getRecentOrders(outletId, limit)` - Recent orders

---

### 3.2 Inventory Management (`/inventory`)

#### **View Inventory**
```
Load Inventory Page â†’ InventoryService.getInventoryItems()
    â†“
Filter by Outlet (Manager: Only assigned outlet)
    â†“
Convert Image URLs (Storage paths â†’ Signed URLs)
    â†“
Display Items with:
    - Item Code (Auto-generated: ITEM-HYBITS-001-001)
    - Name, Category, Condition
    - Quantities (Total, Available, Reserved)
    - Unit Price
    - Images (with fallback)
```

#### **Create Inventory Item**
```
Click "+ Add Item" â†’ NewItemPage
    â†“
Fill Form:
    - Name, Description
    - Category, Subcategory
    - Location (Outlet)
    - Condition
    - Quantities
    - Unit Price
    - Upload Image (Optional)
    â†“
Image Upload â†’ imageService.uploadImage()
    Path: {outlet_id}/{item_code}/{timestamp_filename}
    â†“
Save â†’ InventoryService.createInventoryItem()
    â†“
Item Code Auto-generated by Database Trigger
    â†“
Redirect to Inventory List
```

#### **Update Inventory Item**
```
Click Edit â†’ EditItemPage
    â†“
Load Item Data â†’ Pre-fill Form
    â†“
Update Fields â†’ Save Changes
    â†“
InventoryService.updateInventoryItem()
    â†“
Refresh List
```

#### **Delete Inventory Item**
```
Click Delete â†’ Confirmation Dialog
    â†“
Check if Item Used in Orders:
    Query: rental_order_items WHERE item_id = ?
    â†“
If Used: Show Error "Cannot delete - Used in orders"
If Not Used: InventoryService.deleteInventoryItem()
    â†“
Hard Delete from Database
    â†“
Refresh List
```

---

### 3.3 Customer Management (`/customers`)

#### **View Customers**
```
Load Customers Page â†’ CustomerService.getCustomers()
    â†“
Filter by Status (Default: 'active' only)
    â†“
Display Table:
    - Customer Code (Auto-generated: CUST-YYYY-001)
    - Name, Email, Phone
    - Company, GSTIN
    - Address
    - Status (Active/Inactive/Suspended)
```

#### **Create Customer**
```
Click "+ Add Customer" â†’ NewCustomerPage
    â†“
Fill Form:
    - Name, Email, Phone
    - Company (Optional)
    - Address (Street, City, State, Pincode, Country)
    - GSTIN (Optional)
    - Status (Default: Active)
    â†“
Save â†’ CustomerService.createCustomer()
    â†“
Customer Code Auto-generated
    â†“
Redirect to Customers List
```

#### **Delete Customer (Soft Delete)**
```
Click Delete â†’ Confirmation Dialog
    â†“
CustomerService.deleteCustomer(id)
    â†“
Update Status to 'inactive'
    â†“
Filter Applied: Only 'active' customers shown by default
    â†“
Refresh List (Deleted customer hidden)
```

---

### 3.4 Order Management (`/orders`)

#### **View Orders**
```
Load Orders Page â†’ OrderService.getOrders()
    â†“
Filter by Status (Default: Exclude 'cancelled')
    â†“
Display Order Cards:
    - Order Number (Auto-generated: ORD-OUTCODE-001)
    - Customer Name
    - Event Date, Event Type
    - Status (Pending/Confirmed/Items Dispatched/Items Returned/Completed/Cancelled)
    - Total Amount
    - Payment Status
```

#### **Create Order** â­ **CRITICAL WORKFLOW**
```
Click "+ Add Order" â†’ NewOrderPage
    â†“
Step 1: Select Customer
    CustomerService.getCustomers() â†’ Select from dropdown
    â†“
Step 2: Enter Event Details
    - Event Date (Indian Date Format: DD-MM-YYYY)
    - Event Type (Wedding/Corporate/Birthday/Anniversary/Other)
    - Event Duration (Days)
    - Guest Count
    - Location Type (Indoor/Outdoor/Both)
    â†“
Step 3: Add Inventory Items
    Load Inventory â†’ Select Items
    For Each Item:
        - Quantity
        - Rental Days
        - Rate (Auto-filled from inventory)
        - GST Rate (Default: 18%)
    â†“
Step 4: Review & Submit
    Calculate Total Amount
    â†“
Save Order â†’ OrderService.createOrder()
    â†“
Order Created in Database:
    - Order Number Auto-generated
    - Status: 'pending'
    - Payment Status: 'pending'
    â†“
**AUTOMATIC INVOICE GENERATION** (With Retry Logic)
    â†“
Invoice Creation Process:
    1. Fetch Outlet State (from locations table)
    2. Fetch Customer State (from customers table)
    3. Build Tax Lines (qty, rate, gstRate, outletState, customerState)
    4. Calculate Tax (CGST/SGST/IGST) using Tax Engine
    5. Create Invoice Record
    6. Create Invoice Items
    7. Audit Log Entry (Success/Failure)
    â†“
If Invoice Creation Fails:
    - Retry up to 3 times with exponential backoff
    - Log each attempt in invoice_creation_audit table
    â†“
Order Created Successfully
    â†“
Redirect to Orders List
```

#### **Update Order Status**
```
Click Order â†’ View Details
    â†“
Update Status:
    - pending â†’ confirmed
    - confirmed â†’ items_dispatched
    - items_dispatched â†’ items_returned
    - items_returned â†’ completed
    â†“
OrderService.updateOrder()
    â†“
Refresh Order List
```

#### **Delete Order (Soft Delete)**
```
Click Delete â†’ Confirmation Dialog
    â†“
OrderService.deleteOrder(id)
    â†“
Update Status to 'cancelled'
    â†“
Filter Applied: 'cancelled' orders hidden by default
    â†“
Refresh List
```

---

### 3.5 Invoice Management (`/accounting/invoices`)

#### **View Invoices**
```
Load Invoices Page â†’ InvoiceService.getInvoices()
    â†“
Display Invoice Table:
    - Invoice Number (Auto-generated: INVOICE-OUTCODE-001)
    - Customer Name
    - Invoice Date, Due Date
    - Amount (Subtotal, GST, Total)
    - Payment Status (Pending/Partial/Paid/Overdue)
    - Actions (View, Download, Delete)
```

#### **View Invoice Details**
```
Click View â†’ InvoiceDetailsModal
    â†“
Display:
    - Invoice Header (Number, Date, Due Date)
    - Customer Details
    - Invoice Items (Description, Qty, Rate, GST, Amount)
    - Tax Breakdown (CGST, SGST, IGST)
    - Total Amount
    - Payment Status
    - Payment History
```

#### **Download Invoice PDF**
```
Click Download â†’ InvoiceService.downloadInvoicePDF()
    â†“
Generate PDF (if not exists)
    â†“
Upload to Supabase Storage
    â†“
Return Signed URL
    â†“
Download PDF File
```

#### **Delete Invoice**
```
Click Delete â†’ Confirmation Dialog
    â†“
Check Payment Status:
    If Paid: Show Error "Cannot delete paid invoice"
    If Unpaid: Check for Associated Payments
    â†“
If Payments Exist: Show Error "Delete payments first"
    â†“
If No Payments:
    1. Delete Invoice Items
    2. Delete Invoice Record (Hard Delete)
    â†“
Refresh Invoice List
```

---

### 3.6 Payment Management (`/accounting/payments`)

#### **View Payments**
```
Load Payments Page â†’ PaymentService.getPayments()
    â†“
Display Payment Table:
    - Payment ID
    - Invoice Number
    - Customer Name
    - Amount
    - Payment Date
    - Payment Method
    - Status
```

#### **Record Payment**
```
Click "+ Add Payment" â†’ NewPaymentPage
    â†“
Select Invoice â†’ Load Invoice Details
    â†“
Enter Payment Details:
    - Amount
    - Payment Date
    - Payment Method (Cash/Card/UPI/Bank Transfer)
    - Reference Number (Optional)
    - Notes (Optional)
    â†“
Save â†’ PaymentService.createPayment()
    â†“
Update Invoice Payment Status:
    - Calculate Total Paid
    - Update Status (Pending â†’ Partial â†’ Paid)
    â†“
Refresh Payments List
```

---

### 3.7 Subscription Management

#### **Customer Subscriptions** (`/subscriptions/customer`)
```
Load Subscriptions Page â†’ SubscriptionService.getCustomerSubscriptions()
    â†“
Display Subscription List:
    - Customer Name
    - Plan Details
    - Start Date, End Date
    - Status (Active/Suspended/Cancelled)
    - Renewal Date
```

#### **Vendor Subscriptions** (`/subscriptions`)
```
Load Vendor Subscriptions â†’ BillingService.getVendorSubscriptions()
    â†“
Display Subscription Table:
    - Vendor Name
    - Service Type
    - Monthly Fee
    - Start Date, End Date
    - Status (Active/Cancelled)
    â†“
Delete Subscription (Soft Delete):
    Click Delete â†’ Confirmation
    â†“
BillingService.deleteVendorSubscription()
    â†“
Update Status to 'cancelled'
    â†“
Filter Applied: 'cancelled' subscriptions hidden
```

---

### 3.8 Vendor Management (`/vendors`)

#### **View Vendors**
```
Load Vendors Page â†’ VendorService.getVendors()
    â†“
Filter by Status (Default: Exclude 'terminated')
    â†“
Display Vendor List:
    - Vendor Code
    - Name, Contact
    - Services
    - Status (Active/Terminated)
```

#### **Delete Vendor (Soft Delete)**
```
Click Delete â†’ Confirmation Dialog
    â†“
VendorService.deleteVendor(id)
    â†“
Update Status to 'terminated'
    â†“
Filter Applied: 'terminated' vendors hidden
```

---

### 3.9 Administration Modules

#### **Outlets** (`/outlets`) - Admin Only
```
Load Outlets Page â†’ OutletService.getAllOutlets()
    â†“
Display Outlet List:
    - Outlet Code
    - Name, Address
    - Contact Details
    â†“
Create/Edit/Delete Outlets
    â†“
Delete: Hard Delete (if no dependencies)
```

#### **Users** (`/users`) - Admin Only
```
Load Users Page â†’ AuthService.getAllUsers()
    â†“
Display User List:
    - User Code
    - Name, Email
    - Role
    - Assigned Outlet
    - Status (Active/Inactive)
    â†“
Create/Edit/Delete Users
```

#### **Settings** (`/settings`) - Admin Only
```
Load Settings Page
    â†“
System Configuration
    - General Settings
    - Tax Configuration
    - Notification Settings
```

#### **Overdue Runner** (`/admin/overdue-runner`)
```
Load Overdue Runner Page
    â†“
Display Overdue Invoices:
    - Invoice Number
    - Customer Name
    - Due Date
    - Days Overdue
    - Amount Due
    â†“
Actions:
    - Send Reminder
    - Mark as Resolved
```

---

## 4. CORE BUSINESS WORKFLOWS

### 4.1 Complete Order-to-Payment Flow â­

```
1. CREATE ORDER
   â”œâ”€ Select Customer
   â”œâ”€ Enter Event Details
   â”œâ”€ Add Inventory Items
   â””â”€ Submit Order
       â†“
2. AUTOMATIC INVOICE GENERATION
   â”œâ”€ Fetch Outlet & Customer States
   â”œâ”€ Calculate Tax (CGST/SGST/IGST)
   â”œâ”€ Create Invoice Record
   â”œâ”€ Create Invoice Items
   â””â”€ Audit Log Entry
       â†“
3. ORDER STATUS UPDATES
   â”œâ”€ Pending â†’ Confirmed
   â”œâ”€ Confirmed â†’ Items Dispatched
   â”œâ”€ Items Dispatched â†’ Items Returned
   â””â”€ Items Returned â†’ Completed
       â†“
4. PAYMENT RECORDING
   â”œâ”€ Select Invoice
   â”œâ”€ Enter Payment Details
   â”œâ”€ Record Payment
   â””â”€ Update Invoice Status
       â†“
5. PAYMENT STATUS UPDATES
   â”œâ”€ Pending â†’ Partial (if partial payment)
   â””â”€ Partial/Pending â†’ Paid (if full payment)
```

### 4.2 Tax Calculation Flow

```
Order/Invoice Items
    â†“
For Each Item:
    - Quantity Ã— Rate = Base Amount
    - GST Rate Applied (Default: 18%)
    â†“
Tax Engine Calculation:
    â”œâ”€ Check Outlet State & Customer State
    â”œâ”€ If Same State: CGST + SGST
    â”œâ”€ If Different State: IGST
    â””â”€ Calculate Tax Amounts
    â†“
Invoice Totals:
    - Taxable Value (Sum of base amounts)
    - CGST Total
    - SGST Total
    - IGST Total
    - Total GST
    - Grand Total
```

---

## 5. DATA FLOW & INTEGRATION

### 5.1 Database Tables & Relationships

```
users (Auth)
    â†“
user_profiles (User Details)
    â”œâ”€ â†’ outlets (outlet_id)
    â””â”€ â†’ roles (admin/manager/accountant)
        â†“
customers
    â”œâ”€ â†’ orders (customer_id)
    â””â”€ â†’ invoices (customer_id)
        â†“
inventory_items
    â”œâ”€ â†’ outlets (outlet_id)
    â””â”€ â†’ rental_order_items (item_id)
        â†“
rental_orders
    â”œâ”€ â†’ customers (customer_id)
    â”œâ”€ â†’ outlets (outlet_id)
    â”œâ”€ â†’ users (created_by)
    â””â”€ â†’ invoices (order_id)
        â†“
invoices
    â”œâ”€ â†’ customers (customer_id)
    â”œâ”€ â†’ orders (order_id)
    â”œâ”€ â†’ outlets (outlet_id)
    â””â”€ â†’ invoice_items (invoice_id)
        â†“
payments
    â””â”€ â†’ invoices (invoice_id)
```

### 5.2 Auto-Generated Codes

| Entity | Format | Example | Trigger |
|--------|--------|---------|---------|
| Customer | CUST-YYYY-XXX | CUST-2025-001 | Database Trigger |
| Inventory Item | ITEM-OUTCODE-XXX | ITEM-HYBITS-001-001 | Database Trigger |
| Order | ORD-OUTCODE-XXX | ORD-HYBITS-001 | Database Trigger |
| Invoice | INVOICE-OUTCODE-XXX | INVOICE-HYBITS-001 | Database Trigger |
| Location | LOC-XXX | LOC-001 | Database Trigger |
| Outlet | OUT-XXX | OUT-001 | Database Trigger |
| User | USR-XXX | USR-001 | Database Trigger |

---

## 6. DELETE FUNCTIONALITY

### 6.1 Hard Delete (Permanent Removal)
**Used For:**
- Inventory Items (if not used in orders)
- Invoices (if unpaid and no payments)
- Outlets (if no dependencies)
- Locations (if no dependencies)

**Process:**
```
Click Delete â†’ Confirmation Dialog
    â†“
Check Dependencies:
    - Inventory: Check rental_order_items
    - Invoice: Check payments table
    â†“
If Dependencies Exist: Show Error
If No Dependencies: Delete from Database
    â†“
Refresh List
```

### 6.2 Soft Delete (Status Update)
**Used For:**
- Customers â†’ Status: 'inactive'
- Orders â†’ Status: 'cancelled'
- Vendors â†’ Status: 'terminated'
- Vendor Subscriptions â†’ Status: 'cancelled'

**Process:**
```
Click Delete â†’ Confirmation Dialog
    â†“
Update Status Field
    â†“
Filter Applied: Soft-deleted items hidden by default
    â†“
Refresh List (Item no longer visible)
```

### 6.3 Delete Functionality Summary

| Module | Delete Type | Status Change | Filter Behavior |
|--------|-------------|---------------|-----------------|
| Inventory | Hard Delete | N/A | Removed from list |
| Customers | Soft Delete | inactive | Hidden (default: active only) |
| Orders | Soft Delete | cancelled | Hidden (default: exclude cancelled) |
| Invoices | Hard Delete | N/A | Removed from list |
| Vendors | Soft Delete | terminated | Hidden (default: exclude terminated) |
| Vendor Subscriptions | Soft Delete | cancelled | Hidden (default: exclude cancelled) |
| Outlets | Hard Delete | N/A | Removed from list |
| Locations | Hard Delete | N/A | Removed from list |

---

## 7. IMAGE HANDLING FLOW

### 7.1 Image Upload Flow
```
User Selects Image â†’ File Input
    â†“
imageService.uploadImage(file, outletId, itemCode)
    â†“
Upload to Supabase Storage:
    Bucket: inventory-images
    Path: {outlet_id}/{item_code}/{timestamp_filename}
    â†“
Return Storage Path
    â†“
Save Path to Database (inventory_items.image_url)
```

### 7.2 Image Display Flow
```
Load Inventory Item â†’ Get image_url from Database
    â†“
Check URL Type:
    â”œâ”€ If Full URL (http/https): Use Directly
    â”œâ”€ If Public Asset (/assets/): Use Directly
    â””â”€ If Storage Path: Convert to Signed URL
        â†“
imageService.getSignedUrl(storagePath)
    â†“
Try Path Resolution:
    1. Try Exact Path
    2. Try Alternative Paths:
       - inventory/default/filename â†’ default/filename
       - default/filename â†’ filename
    3. Search by Filename
    â†“
Generate Signed URL (24-hour expiry)
    â†“
Display Image (AppImage Component)
    â†“
If Error: Show Fallback Image (/assets/images/no_image.png)
```

### 7.3 Image Path Resolution Logic
```
Database Path: inventory/default/1764153036523_logo1.jpg
    â†“
Try Paths in Order:
    1. inventory/default/1764153036523_logo1.jpg âŒ
    2. default/1764153036523_logo1.jpg âœ… (If exists)
    3. 1764153036523_logo1.jpg âœ… (If exists)
    4. Search by filename âœ… (If exists)
    â†“
If Found: Generate Signed URL
If Not Found: Show Fallback Image
```

---

## 8. TESTING CHECKLIST

### 8.1 Authentication & Authorization
- [ ] Login with valid credentials
- [ ] Login with invalid credentials (error handling)
- [ ] Session persistence (refresh page)
- [ ] Logout functionality
- [ ] Role-based access control (Admin/Manager/Accountant)
- [ ] Permission-based menu visibility
- [ ] Outlet assignment (Manager: assigned outlet only)

### 8.2 Dashboard
- [ ] Load dashboard statistics (Admin view)
- [ ] Load dashboard statistics (Manager view)
- [ ] Recent orders display
- [ ] Quick actions functionality
- [ ] Outlet switching (Admin)

### 8.3 Inventory Management
- [ ] View inventory list
- [ ] Filter by category/condition
- [ ] Search inventory items
- [ ] Create new inventory item
- [ ] Upload inventory image
- [ ] Image display (with fallback)
- [ ] Edit inventory item
- [ ] Delete inventory item (hard delete)
- [ ] Prevent delete if used in orders
- [ ] Export inventory data

### 8.4 Customer Management
- [ ] View customers list
- [ ] Filter by status (active/inactive)
- [ ] Search customers
- [ ] Create new customer
- [ ] Edit customer details
- [ ] Delete customer (soft delete - inactive)
- [ ] Verify deleted customers hidden by default
- [ ] View customer with "All Status" filter

### 8.5 Order Management
- [ ] View orders list
- [ ] Filter by status
- [ ] Search orders
- [ ] Create new order
  - [ ] Select customer
  - [ ] Enter event details
  - [ ] Add inventory items
  - [ ] Calculate totals
- [ ] Automatic invoice generation
- [ ] Invoice creation retry logic
- [ ] Update order status
- [ ] Delete order (soft delete - cancelled)
- [ ] Verify cancelled orders hidden by default
- [ ] View order details modal

### 8.6 Invoice Management
- [ ] View invoices list
- [ ] Filter invoices
- [ ] Search invoices
- [ ] View invoice details
- [ ] Download invoice PDF
- [ ] Delete invoice (hard delete)
- [ ] Prevent delete if paid
- [ ] Prevent delete if has payments
- [ ] Tax calculation (CGST/SGST/IGST)

### 8.7 Payment Management
- [ ] View payments list
- [ ] Record payment
- [ ] Update invoice payment status
- [ ] Partial payment handling
- [ ] Full payment handling
- [ ] Payment history

### 8.8 Subscription Management
- [ ] View customer subscriptions
- [ ] View vendor subscriptions
- [ ] Delete vendor subscription (soft delete)
- [ ] Verify cancelled subscriptions hidden

### 8.9 Vendor Management
- [ ] View vendors list
- [ ] Create vendor
- [ ] Edit vendor
- [ ] Delete vendor (soft delete - terminated)
- [ ] Verify terminated vendors hidden

### 8.10 Administration
- [ ] Outlet management (Admin only)
- [ ] User management (Admin only)
- [ ] Settings access (Admin only)
- [ ] Overdue runner functionality

### 8.11 Delete Functionality
- [ ] Inventory: Hard delete (check dependencies)
- [ ] Customers: Soft delete (status: inactive)
- [ ] Orders: Soft delete (status: cancelled)
- [ ] Invoices: Hard delete (check payments)
- [ ] Vendors: Soft delete (status: terminated)
- [ ] Vendor Subscriptions: Soft delete (status: cancelled)
- [ ] Outlets: Hard delete (check dependencies)
- [ ] Locations: Hard delete (check dependencies)

### 8.12 Image Handling
- [ ] Upload inventory image
- [ ] Image display with correct path
- [ ] Fallback image display (if image missing)
- [ ] Alternative path resolution
- [ ] Signed URL generation
- [ ] Image error handling

### 8.13 Data Integrity
- [ ] Auto-generated codes (Customer, Order, Invoice, etc.)
- [ ] Foreign key constraints
- [ ] Data validation
- [ ] Error handling
- [ ] Transaction rollback (if applicable)

### 8.14 Performance
- [ ] Page load times
- [ ] Large dataset handling
- [ ] Image loading performance
- [ ] Search/filter performance

---

## 9. KEY INTEGRATION POINTS

### 9.1 Supabase Integration
- **Authentication**: Supabase Auth
- **Database**: PostgreSQL (Supabase)
- **Storage**: Supabase Storage (inventory-images bucket)
- **Real-time**: Supabase Realtime (if enabled)

### 9.2 Tax Engine Integration
- **Tax Calculation**: `calculateInvoiceFromLines()` function
- **GST Rates**: Configurable (Default: 18%)
- **State-based Tax**: CGST/SGST (same state) vs IGST (different state)

### 9.3 Code Generation
- **Auto-generation**: Database triggers
- **Format**: Prefix-Outcode-Sequence
- **Uniqueness**: Enforced by database constraints

---

## 10. ERROR HANDLING & VALIDATION

### 10.1 Common Error Scenarios
1. **Foreign Key Violations**: Prevent deletion of referenced records
2. **Image Not Found**: Show fallback image
3. **Invoice Creation Failure**: Retry with audit logging
4. **Invalid GST Rates**: Validation before save
5. **Missing Required Fields**: Form validation
6. **Session Expired**: Redirect to login

### 10.2 Validation Rules
- **Email**: Valid email format
- **Phone**: Indian phone number format
- **Date**: Indian date format (DD-MM-YYYY)
- **GST Rate**: Valid GST rates (0%, 5%, 12%, 18%, 28%)
- **Amounts**: Positive numbers, 2 decimal places
- **Quantities**: Positive integers

---

## END OF DOCUMENTATION

**Last Updated**: December 2025
**Version**: 1.0
**Prepared For**: Testing Planning

